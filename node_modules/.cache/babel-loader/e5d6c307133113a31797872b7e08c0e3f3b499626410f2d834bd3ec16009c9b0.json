{"ast":null,"code":"/**\n * DEBUG=nightmare*\n */\n\nvar log = require('debug')('nightmare:log');\nvar debug = require('debug')('nightmare');\nvar electronLog = {\n  stdout: require('debug')('electron:stdout'),\n  stderr: require('debug')('electron:stderr')\n};\n\n/**\n * Module dependencies\n */\n\nvar default_electron_path = require('electron');\nvar proc = require('child_process');\nvar actions = require('./actions');\nvar path = require('path');\nvar sliced = require('sliced');\nvar child = require('./ipc');\nvar once = require('once');\nvar split2 = require('split2');\nvar defaults = require('defaults');\nvar noop = function () {};\nvar keys = Object.keys;\n\n// Standard timeout for loading URLs\nconst DEFAULT_GOTO_TIMEOUT = 30 * 1000;\n// Standard timeout for wait(ms)\nconst DEFAULT_WAIT_TIMEOUT = 30 * 1000;\n// Timeout between keystrokes for `.type()`\nconst DEFAULT_TYPE_INTERVAL = 100;\n// timeout between `wait` polls\nconst DEFAULT_POLL_INTERVAL = 250;\n// max retry for authentication\nconst MAX_AUTH_RETRIES = 3;\n// max execution time for `.evaluate()`\nconst DEFAULT_EXECUTION_TIMEOUT = 30 * 1000;\n// Error message when halted\nconst DEFAULT_HALT_MESSAGE = 'Nightmare Halted';\n// Non-persistent partition to use by defaults\nconst DEFAULT_PARTITION = 'nightmare';\n\n/**\n * Export `Nightmare`\n */\n\nmodule.exports = Nightmare;\n\n/**\n * runner script\n */\n\nvar runner = path.join(__dirname, 'runner.js');\n\n/**\n * Template\n */\n\nvar template = require('./javascript');\n\n/**\n * Initialize `Nightmare`\n *\n * @param {Object} options\n */\n\nfunction Nightmare(options) {\n  if (!(this instanceof Nightmare)) return new Nightmare(options);\n  options = options || {};\n  var electronArgs = {};\n  var self = this;\n  options.waitTimeout = options.waitTimeout || DEFAULT_WAIT_TIMEOUT;\n  options.gotoTimeout = options.gotoTimeout || DEFAULT_GOTO_TIMEOUT;\n  options.pollInterval = options.pollInterval || DEFAULT_POLL_INTERVAL;\n  options.typeInterval = options.typeInterval || DEFAULT_TYPE_INTERVAL;\n  options.executionTimeout = options.executionTimeout || DEFAULT_EXECUTION_TIMEOUT;\n  options.webPreferences = options.webPreferences || {};\n\n  // null is a valid value, which will result in the use of the electron default behavior, which is to persist storage.\n  // The default behavior for nightmare will be to use non-persistent storage.\n  // http://electron.atom.io/docs/api/browser-window/#new-browserwindowoptions\n  options.webPreferences.partition = options.webPreferences.partition !== undefined ? options.webPreferences.partition : DEFAULT_PARTITION;\n  options.Promise = options.Promise || Nightmare.Promise || Promise;\n  var electron_path = options.electronPath || default_electron_path;\n  if (options.paths) {\n    electronArgs.paths = options.paths;\n  }\n  if (options.switches) {\n    electronArgs.switches = options.switches;\n  }\n  options.maxAuthRetries = options.maxAuthRetries || MAX_AUTH_RETRIES;\n  electronArgs.loadTimeout = options.loadTimeout;\n  if (options.loadTimeout && options.gotoTimeout && options.loadTimeout < options.gotoTimeout) {\n    debug(`WARNING:  load timeout of ${options.loadTimeout} is shorter than goto timeout of ${options.gotoTimeout}`);\n  }\n  electronArgs.dock = options.dock || false;\n  electronArgs.certificateSubjectName = options.certificateSubjectName || null;\n  attachToProcess(this);\n\n  // initial state\n  this.state = 'initial';\n  this.running = false;\n  this.ending = false;\n  this.ended = false;\n  this._queue = [];\n  this._headers = {};\n  this.options = options;\n  debug('queuing process start');\n  this.queue(done => {\n    this.proc = proc.spawn(electron_path, [runner].concat(JSON.stringify(electronArgs)), {\n      stdio: [null, null, null, 'ipc'],\n      env: defaults(options.env || {}, process.env)\n    });\n    this.proc.stdout.pipe(split2()).on('data', data => {\n      electronLog.stdout(data);\n    });\n    this.proc.stderr.pipe(split2()).on('data', data => {\n      electronLog.stderr(data);\n    });\n    this.proc.on('close', code => {\n      if (!self.ended) {\n        handleExit(code, self, noop);\n      }\n    });\n    this.child = child(this.proc);\n    this.child.once('die', function (err) {\n      debug('dying: ' + err);\n      self.die = err;\n    });\n\n    // propagate console.log(...) through\n    this.child.on('log', function () {\n      log.apply(log, arguments);\n    });\n    this.child.on('uncaughtException', function (err) {\n      const e = new Error('Nightmare runner error: ' + err.message);\n      e.stack = err.stack || '';\n      const onClose = () => {\n        throw err;\n      };\n      endInstance(self, onClose, true);\n    });\n    this.child.on('page', function (type) {\n      log.apply(null, ['page-' + type].concat(sliced(arguments, 1)));\n    });\n\n    // propogate events through to debugging\n    this.child.on('did-finish-load', function () {\n      log('did-finish-load', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-fail-load', function () {\n      log('did-fail-load', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-fail-provisional-load', function () {\n      log('did-fail-provisional-load', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-frame-finish-load', function () {\n      log('did-frame-finish-load', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-start-loading', function () {\n      log('did-start-loading', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-stop-loading', function () {\n      log('did-stop-loading', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-get-response-details', function () {\n      log('did-get-response-details', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('did-get-redirect-request', function () {\n      log('did-get-redirect-request', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('dom-ready', function () {\n      log('dom-ready', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('page-favicon-updated', function () {\n      log('page-favicon-updated', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('new-window', function () {\n      log('new-window', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('will-navigate', function () {\n      log('will-navigate', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('crashed', function () {\n      log('crashed', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('plugin-crashed', function () {\n      log('plugin-crashed', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('destroyed', function () {\n      log('destroyed', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('media-started-playing', function () {\n      log('media-started-playing', JSON.stringify(sliced(arguments)));\n    });\n    this.child.on('media-paused', function () {\n      log('media-paused', JSON.stringify(sliced(arguments)));\n    });\n    this.child.once('ready', versions => {\n      this.engineVersions = versions;\n      this.child.call('browser-initialize', options, function () {\n        self.state = 'ready';\n        done();\n      });\n    });\n  });\n\n  // initialize namespaces\n  Nightmare.namespaces.forEach(function (name) {\n    if ('function' === typeof this[name]) {\n      this[name] = this[name]();\n    }\n  }, this);\n\n  //prepend adding child actions to the queue\n  Object.keys(Nightmare.childActions).forEach(function (key) {\n    debug('queueing child action addition for \"%s\"', key);\n    this.queue(function (done) {\n      this.child.call('action', key, String(Nightmare.childActions[key]), done);\n    });\n  }, this);\n}\nfunction handleExit(code, instance, cb) {\n  var help = {\n    127: 'command not found - you may not have electron installed correctly',\n    126: 'permission problem or command is not an executable - you may not have all the necessary dependencies for electron',\n    1: 'general error - you may need xvfb',\n    0: 'success!'\n  };\n  debug('electron child process exited with code ' + code + ': ' + help[code]);\n  instance.proc.removeAllListeners();\n  cb();\n}\nfunction endInstance(instance, cb, forceKill) {\n  instance.ended = true;\n  detachFromProcess(instance);\n  if (instance.proc && instance.proc.connected) {\n    instance.proc.on('close', code => {\n      handleExit(code, instance, cb);\n    });\n    instance.child.call('quit', () => {\n      instance.child.removeAllListeners();\n      if (forceKill) {\n        instance.proc.kill('SIGINT');\n      }\n    });\n  } else {\n    debug('electron child process not started yet, skipping kill.');\n    cb();\n  }\n}\n\n/**\n * Attach any instance-specific process-level events.\n */\nfunction attachToProcess(instance) {\n  instance._endNow = endInstance.bind(null, instance, noop);\n  process.setMaxListeners(Infinity);\n  process.on('exit', instance._endNow);\n  process.on('SIGINT', instance._endNow);\n  process.on('SIGTERM', instance._endNow);\n  process.on('SIGQUIT', instance._endNow);\n  process.on('SIGHUP', instance._endNow);\n  process.on('SIGBREAK', instance._endNow);\n}\nfunction detachFromProcess(instance) {\n  process.removeListener('exit', instance._endNow);\n  process.removeListener('SIGINT', instance._endNow);\n  process.removeListener('SIGTERM', instance._endNow);\n  process.removeListener('SIGQUIT', instance._endNow);\n  process.removeListener('SIGHUP', instance._endNow);\n  process.removeListener('SIGBREAK', instance._endNow);\n}\n\n/**\n * Namespaces to initialize\n */\n\nNightmare.namespaces = [];\n\n/**\n * Child actions to create\n */\n\nNightmare.childActions = {};\n\n/**\n * Version\n */\nNightmare.version = require(path.resolve(__dirname, '..', 'package.json')).version;\n\n/**\n * Promise library (can override)\n */\n\nNightmare.Promise = Promise;\n\n/**\n * Override headers for all HTTP requests\n */\n\nNightmare.prototype.header = function (header, value) {\n  if (header && typeof value !== 'undefined') {\n    this._headers[header] = value;\n  } else {\n    this._headers = header || {};\n  }\n  return this;\n};\n\n/**\n * Go to a `url`\n */\n\nNightmare.prototype.goto = function (url, headers) {\n  debug('queueing action \"goto\" for %s', url);\n  var self = this;\n  headers = headers || {};\n  for (var key in this._headers) {\n    headers[key] = headers[key] || this._headers[key];\n  }\n  this.queue(function (fn) {\n    self.child.call('goto', url, headers, this.options.gotoTimeout, fn);\n  });\n  return this;\n};\n\n/**\n * run\n */\n\nNightmare.prototype.run = function (fn) {\n  debug('running');\n  var steps = this.queue();\n  this.running = true;\n  this._queue = [];\n  var self = this;\n\n  // kick us off\n  next();\n\n  // next function\n  function next(err, _res) {\n    var item = steps.shift();\n    // Immediately halt execution if an error has been thrown, or we have no more queued up steps.\n    if (err || !item) return done.apply(self, arguments);\n    var args = item[1] || [];\n    var method = item[0];\n    args.push(once(after));\n    method.apply(self, args);\n  }\n  function after(err, _res) {\n    err = err || self.die;\n    var args = [err].concat(sliced(arguments, 1));\n    if (self.child) {\n      self.child.call('continue', () => next.apply(self, args));\n    } else {\n      next.apply(self, args);\n    }\n  }\n  function done() {\n    var doneargs = arguments;\n    self.running = false;\n    if (self.ending) {\n      return endInstance(self, () => fn.apply(self, doneargs));\n    }\n    return fn.apply(self, doneargs);\n  }\n  return this;\n};\n\n/**\n * run the code now (do not queue it)\n *\n * you should not use this, unless you know what you're doing\n * it should be used for plugins and custom actions, not for\n * normal API usage\n */\n\nNightmare.prototype.evaluate_now = function (js_fn, done) {\n  var args = Array.prototype.slice.call(arguments).slice(2).map(a => {\n    return {\n      argument: JSON.stringify(a)\n    };\n  });\n  var source = template.execute({\n    src: String(js_fn),\n    args: args\n  });\n  this.child.call('javascript', source, done);\n  return this;\n};\n\n/**\n * inject javascript\n */\n\nNightmare.prototype._inject = function (js, done) {\n  this.child.call('javascript', template.inject({\n    src: js\n  }), done);\n  return this;\n};\n\n/**\n * end\n */\n\nNightmare.prototype.end = function (done) {\n  this.ending = true;\n  if (done && !this.running && !this.ended) {\n    return this.then(done);\n  }\n  return this;\n};\n\n/**\n * Halt - Force kills the electron process immediately and empties the queue\n *\n * @param  {Error|String} error (Optional: defaults to 'Nightmare Halted'.) Error to pass to rejected promise\n * @param  {Function} done (Optional: defaults to no operation) callback when the child process exits\n * @return {Nightmare}       returns self\n */\nNightmare.prototype.halt = function (error, done) {\n  this.ending = true;\n  var queue = this.queue(); // empty the queue\n  queue.splice(0);\n  if (!this.ended) {\n    var message = error;\n    if (error instanceof Error) {\n      message = error.message;\n    }\n    this.die = message || DEFAULT_HALT_MESSAGE;\n    if (typeof this._rejectActivePromise === 'function') {\n      this._rejectActivePromise(error || DEFAULT_HALT_MESSAGE);\n    }\n    var callback = done;\n    if (!callback || typeof callback !== 'function') {\n      callback = noop;\n    }\n    endInstance(this, callback, true);\n  }\n  return this;\n};\n\n/**\n * on\n */\n\nNightmare.prototype.on = function (event, handler) {\n  this.queue(function (done) {\n    this.child.on(event, handler);\n    done();\n  });\n  return this;\n};\n\n/**\n * once\n */\n\nNightmare.prototype.once = function (event, handler) {\n  this.queue(function (done) {\n    this.child.once(event, handler);\n    done();\n  });\n  return this;\n};\n\n/**\n * removeEventListener\n */\n\nNightmare.prototype.removeListener = function (event, handler) {\n  this.child.removeListener(event, handler);\n  return this;\n};\n\n/**\n * Queue\n */\n\nNightmare.prototype.queue = function (_done) {\n  if (!arguments.length) return this._queue;\n  var args = sliced(arguments);\n  var fn = args.pop();\n  this._queue.push([fn, args]);\n};\n\n/**\n * then\n */\n\nNightmare.prototype.then = function (fulfill, reject) {\n  var self = this;\n  return new this.options.Promise(function (success, failure) {\n    self._rejectActivePromise = failure;\n    self.run(function (err, result) {\n      if (err) failure(err);else success(result);\n    });\n  }).then(fulfill, reject);\n};\n\n/**\n * catch\n */\n\nNightmare.prototype.catch = function (reject) {\n  this._rejectActivePromise = reject;\n  return this.then(undefined, reject);\n};\n\n/**\n * use\n */\n\nNightmare.prototype.use = function (fn) {\n  fn(this);\n  return this;\n};\n\n// wrap all the functions in the queueing function\nfunction queued(name, fn) {\n  return function action() {\n    debug('queueing action \"' + name + '\"');\n    var args = [].slice.call(arguments);\n    this._queue.push([fn, args]);\n    return this;\n  };\n}\n\n/**\n * Static: Support attaching custom actions\n *\n * @param {String} name - method name\n * @param {Function|Object} [childfn] - Electron implementation\n * @param {Function|Object} parentfn - Nightmare implementation\n * @return {Nightmare}\n */\n\nNightmare.action = function () {\n  var name = arguments[0],\n    childfn,\n    parentfn;\n  if (arguments.length === 2) {\n    parentfn = arguments[1];\n  } else {\n    parentfn = arguments[2];\n    childfn = arguments[1];\n  }\n\n  // support functions and objects\n  // if it's an object, wrap it's\n  // properties in the queue function\n\n  if (parentfn) {\n    if (typeof parentfn === 'function') {\n      Nightmare.prototype[name] = queued(name, parentfn);\n    } else {\n      if (!~Nightmare.namespaces.indexOf(name)) {\n        Nightmare.namespaces.push(name);\n      }\n      Nightmare.prototype[name] = function () {\n        var self = this;\n        return keys(parentfn).reduce(function (obj, key) {\n          obj[key] = queued(name, parentfn[key]).bind(self);\n          return obj;\n        }, {});\n      };\n    }\n  }\n  if (childfn) {\n    if (typeof childfn === 'function') {\n      Nightmare.childActions[name] = childfn;\n    } else {\n      for (var key in childfn) {\n        Nightmare.childActions[name + '.' + key] = childfn[key];\n      }\n    }\n  }\n};\n\n/**\n * Attach all the actions.\n */\n\nObject.keys(actions).forEach(function (name) {\n  var fn = actions[name];\n  Nightmare.action(name, fn);\n});","map":{"version":3,"names":["log","require","debug","electronLog","stdout","stderr","default_electron_path","proc","actions","path","sliced","child","once","split2","defaults","noop","keys","Object","DEFAULT_GOTO_TIMEOUT","DEFAULT_WAIT_TIMEOUT","DEFAULT_TYPE_INTERVAL","DEFAULT_POLL_INTERVAL","MAX_AUTH_RETRIES","DEFAULT_EXECUTION_TIMEOUT","DEFAULT_HALT_MESSAGE","DEFAULT_PARTITION","module","exports","Nightmare","runner","join","__dirname","template","options","electronArgs","self","waitTimeout","gotoTimeout","pollInterval","typeInterval","executionTimeout","webPreferences","partition","undefined","Promise","electron_path","electronPath","paths","switches","maxAuthRetries","loadTimeout","dock","certificateSubjectName","attachToProcess","state","running","ending","ended","_queue","_headers","queue","done","spawn","concat","JSON","stringify","stdio","env","process","pipe","on","data","code","handleExit","err","die","apply","arguments","e","Error","message","stack","onClose","endInstance","type","versions","engineVersions","call","namespaces","forEach","name","childActions","key","String","instance","cb","help","removeAllListeners","forceKill","detachFromProcess","connected","kill","_endNow","bind","setMaxListeners","Infinity","removeListener","version","resolve","prototype","header","value","goto","url","headers","fn","run","steps","next","_res","item","shift","args","method","push","after","doneargs","evaluate_now","js_fn","Array","slice","map","a","argument","source","execute","src","_inject","js","inject","end","then","halt","error","splice","_rejectActivePromise","callback","event","handler","_done","length","pop","fulfill","reject","success","failure","result","catch","use","queued","action","childfn","parentfn","indexOf","reduce","obj"],"sources":["/Users/nicolecheung/my-recipes/node_modules/nightmare/lib/nightmare.js"],"sourcesContent":["/**\n * DEBUG=nightmare*\n */\n\nvar log = require('debug')('nightmare:log')\nvar debug = require('debug')('nightmare')\nvar electronLog = {\n  stdout: require('debug')('electron:stdout'),\n  stderr: require('debug')('electron:stderr')\n}\n\n/**\n * Module dependencies\n */\n\nvar default_electron_path = require('electron')\nvar proc = require('child_process')\nvar actions = require('./actions')\nvar path = require('path')\nvar sliced = require('sliced')\nvar child = require('./ipc')\nvar once = require('once')\nvar split2 = require('split2')\nvar defaults = require('defaults')\nvar noop = function() {}\nvar keys = Object.keys\n\n// Standard timeout for loading URLs\nconst DEFAULT_GOTO_TIMEOUT = 30 * 1000\n// Standard timeout for wait(ms)\nconst DEFAULT_WAIT_TIMEOUT = 30 * 1000\n// Timeout between keystrokes for `.type()`\nconst DEFAULT_TYPE_INTERVAL = 100\n// timeout between `wait` polls\nconst DEFAULT_POLL_INTERVAL = 250\n// max retry for authentication\nconst MAX_AUTH_RETRIES = 3\n// max execution time for `.evaluate()`\nconst DEFAULT_EXECUTION_TIMEOUT = 30 * 1000\n// Error message when halted\nconst DEFAULT_HALT_MESSAGE = 'Nightmare Halted'\n// Non-persistent partition to use by defaults\nconst DEFAULT_PARTITION = 'nightmare'\n\n/**\n * Export `Nightmare`\n */\n\nmodule.exports = Nightmare\n\n/**\n * runner script\n */\n\nvar runner = path.join(__dirname, 'runner.js')\n\n/**\n * Template\n */\n\nvar template = require('./javascript')\n\n/**\n * Initialize `Nightmare`\n *\n * @param {Object} options\n */\n\nfunction Nightmare(options) {\n  if (!(this instanceof Nightmare)) return new Nightmare(options)\n  options = options || {}\n  var electronArgs = {}\n  var self = this\n\n  options.waitTimeout = options.waitTimeout || DEFAULT_WAIT_TIMEOUT\n  options.gotoTimeout = options.gotoTimeout || DEFAULT_GOTO_TIMEOUT\n  options.pollInterval = options.pollInterval || DEFAULT_POLL_INTERVAL\n\n  options.typeInterval = options.typeInterval || DEFAULT_TYPE_INTERVAL\n  options.executionTimeout =\n    options.executionTimeout || DEFAULT_EXECUTION_TIMEOUT\n  options.webPreferences = options.webPreferences || {}\n\n  // null is a valid value, which will result in the use of the electron default behavior, which is to persist storage.\n  // The default behavior for nightmare will be to use non-persistent storage.\n  // http://electron.atom.io/docs/api/browser-window/#new-browserwindowoptions\n  options.webPreferences.partition =\n    options.webPreferences.partition !== undefined\n      ? options.webPreferences.partition\n      : DEFAULT_PARTITION\n\n  options.Promise = options.Promise || Nightmare.Promise || Promise\n\n  var electron_path = options.electronPath || default_electron_path\n\n  if (options.paths) {\n    electronArgs.paths = options.paths\n  }\n\n  if (options.switches) {\n    electronArgs.switches = options.switches\n  }\n  options.maxAuthRetries = options.maxAuthRetries || MAX_AUTH_RETRIES\n\n  electronArgs.loadTimeout = options.loadTimeout\n  if (\n    options.loadTimeout &&\n    options.gotoTimeout &&\n    options.loadTimeout < options.gotoTimeout\n  ) {\n    debug(\n      `WARNING:  load timeout of ${\n        options.loadTimeout\n      } is shorter than goto timeout of ${options.gotoTimeout}`\n    )\n  }\n\n  electronArgs.dock = options.dock || false\n  electronArgs.certificateSubjectName = options.certificateSubjectName || null\n\n  attachToProcess(this)\n\n  // initial state\n  this.state = 'initial'\n  this.running = false\n  this.ending = false\n  this.ended = false\n  this._queue = []\n  this._headers = {}\n  this.options = options\n\n  debug('queuing process start')\n  this.queue(done => {\n    this.proc = proc.spawn(\n      electron_path,\n      [runner].concat(JSON.stringify(electronArgs)),\n      {\n        stdio: [null, null, null, 'ipc'],\n        env: defaults(options.env || {}, process.env)\n      }\n    )\n\n    this.proc.stdout.pipe(split2()).on('data', data => {\n      electronLog.stdout(data)\n    })\n\n    this.proc.stderr.pipe(split2()).on('data', data => {\n      electronLog.stderr(data)\n    })\n\n    this.proc.on('close', code => {\n      if (!self.ended) {\n        handleExit(code, self, noop)\n      }\n    })\n\n    this.child = child(this.proc)\n\n    this.child.once('die', function(err) {\n      debug('dying: ' + err)\n      self.die = err\n    })\n\n    // propagate console.log(...) through\n    this.child.on('log', function() {\n      log.apply(log, arguments)\n    })\n\n    this.child.on('uncaughtException', function(err) {\n      const e = new Error('Nightmare runner error: ' + err.message)\n      e.stack = err.stack || ''\n\n      const onClose = () => {\n        throw err\n      }\n\n      endInstance(self, onClose, true)\n    })\n\n    this.child.on('page', function(type) {\n      log.apply(null, ['page-' + type].concat(sliced(arguments, 1)))\n    })\n\n    // propogate events through to debugging\n    this.child.on('did-finish-load', function() {\n      log('did-finish-load', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-fail-load', function() {\n      log('did-fail-load', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-fail-provisional-load', function() {\n      log('did-fail-provisional-load', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-frame-finish-load', function() {\n      log('did-frame-finish-load', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-start-loading', function() {\n      log('did-start-loading', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-stop-loading', function() {\n      log('did-stop-loading', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-get-response-details', function() {\n      log('did-get-response-details', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('did-get-redirect-request', function() {\n      log('did-get-redirect-request', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('dom-ready', function() {\n      log('dom-ready', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('page-favicon-updated', function() {\n      log('page-favicon-updated', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('new-window', function() {\n      log('new-window', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('will-navigate', function() {\n      log('will-navigate', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('crashed', function() {\n      log('crashed', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('plugin-crashed', function() {\n      log('plugin-crashed', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('destroyed', function() {\n      log('destroyed', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('media-started-playing', function() {\n      log('media-started-playing', JSON.stringify(sliced(arguments)))\n    })\n    this.child.on('media-paused', function() {\n      log('media-paused', JSON.stringify(sliced(arguments)))\n    })\n\n    this.child.once('ready', versions => {\n      this.engineVersions = versions\n      this.child.call('browser-initialize', options, function() {\n        self.state = 'ready'\n        done()\n      })\n    })\n  })\n\n  // initialize namespaces\n  Nightmare.namespaces.forEach(function(name) {\n    if ('function' === typeof this[name]) {\n      this[name] = this[name]()\n    }\n  }, this)\n\n  //prepend adding child actions to the queue\n  Object.keys(Nightmare.childActions).forEach(function(key) {\n    debug('queueing child action addition for \"%s\"', key)\n    this.queue(function(done) {\n      this.child.call('action', key, String(Nightmare.childActions[key]), done)\n    })\n  }, this)\n}\n\nfunction handleExit(code, instance, cb) {\n  var help = {\n    127: 'command not found - you may not have electron installed correctly',\n    126: 'permission problem or command is not an executable - you may not have all the necessary dependencies for electron',\n    1: 'general error - you may need xvfb',\n    0: 'success!'\n  }\n\n  debug('electron child process exited with code ' + code + ': ' + help[code])\n  instance.proc.removeAllListeners()\n  cb()\n}\n\nfunction endInstance(instance, cb, forceKill) {\n  instance.ended = true\n  detachFromProcess(instance)\n  if (instance.proc && instance.proc.connected) {\n    instance.proc.on('close', code => {\n      handleExit(code, instance, cb)\n    })\n    instance.child.call('quit', () => {\n      instance.child.removeAllListeners()\n      if (forceKill) {\n        instance.proc.kill('SIGINT')\n      }\n    })\n  } else {\n    debug('electron child process not started yet, skipping kill.')\n    cb()\n  }\n}\n\n/**\n * Attach any instance-specific process-level events.\n */\nfunction attachToProcess(instance) {\n  instance._endNow = endInstance.bind(null, instance, noop)\n  process.setMaxListeners(Infinity)\n  process.on('exit', instance._endNow)\n  process.on('SIGINT', instance._endNow)\n  process.on('SIGTERM', instance._endNow)\n  process.on('SIGQUIT', instance._endNow)\n  process.on('SIGHUP', instance._endNow)\n  process.on('SIGBREAK', instance._endNow)\n}\n\nfunction detachFromProcess(instance) {\n  process.removeListener('exit', instance._endNow)\n  process.removeListener('SIGINT', instance._endNow)\n  process.removeListener('SIGTERM', instance._endNow)\n  process.removeListener('SIGQUIT', instance._endNow)\n  process.removeListener('SIGHUP', instance._endNow)\n  process.removeListener('SIGBREAK', instance._endNow)\n}\n\n/**\n * Namespaces to initialize\n */\n\nNightmare.namespaces = []\n\n/**\n * Child actions to create\n */\n\nNightmare.childActions = {}\n\n/**\n * Version\n */\nNightmare.version = require(path.resolve(\n  __dirname,\n  '..',\n  'package.json'\n)).version\n\n/**\n * Promise library (can override)\n */\n\nNightmare.Promise = Promise\n\n/**\n * Override headers for all HTTP requests\n */\n\nNightmare.prototype.header = function(header, value) {\n  if (header && typeof value !== 'undefined') {\n    this._headers[header] = value\n  } else {\n    this._headers = header || {}\n  }\n\n  return this\n}\n\n/**\n * Go to a `url`\n */\n\nNightmare.prototype.goto = function(url, headers) {\n  debug('queueing action \"goto\" for %s', url)\n  var self = this\n\n  headers = headers || {}\n  for (var key in this._headers) {\n    headers[key] = headers[key] || this._headers[key]\n  }\n\n  this.queue(function(fn) {\n    self.child.call('goto', url, headers, this.options.gotoTimeout, fn)\n  })\n  return this\n}\n\n/**\n * run\n */\n\nNightmare.prototype.run = function(fn) {\n  debug('running')\n  var steps = this.queue()\n  this.running = true\n  this._queue = []\n  var self = this\n\n  // kick us off\n  next()\n\n  // next function\n  function next(err, _res) {\n    var item = steps.shift()\n    // Immediately halt execution if an error has been thrown, or we have no more queued up steps.\n    if (err || !item) return done.apply(self, arguments)\n    var args = item[1] || []\n    var method = item[0]\n    args.push(once(after))\n    method.apply(self, args)\n  }\n\n  function after(err, _res) {\n    err = err || self.die\n    var args = [err].concat(sliced(arguments, 1))\n\n    if (self.child) {\n      self.child.call('continue', () => next.apply(self, args))\n    } else {\n      next.apply(self, args)\n    }\n  }\n\n  function done() {\n    var doneargs = arguments\n    self.running = false\n    if (self.ending) {\n      return endInstance(self, () => fn.apply(self, doneargs))\n    }\n    return fn.apply(self, doneargs)\n  }\n\n  return this\n}\n\n/**\n * run the code now (do not queue it)\n *\n * you should not use this, unless you know what you're doing\n * it should be used for plugins and custom actions, not for\n * normal API usage\n */\n\nNightmare.prototype.evaluate_now = function(js_fn, done) {\n  var args = Array.prototype.slice\n    .call(arguments)\n    .slice(2)\n    .map(a => {\n      return { argument: JSON.stringify(a) }\n    })\n  var source = template.execute({ src: String(js_fn), args: args })\n  this.child.call('javascript', source, done)\n  return this\n}\n\n/**\n * inject javascript\n */\n\nNightmare.prototype._inject = function(js, done) {\n  this.child.call('javascript', template.inject({ src: js }), done)\n  return this\n}\n\n/**\n * end\n */\n\nNightmare.prototype.end = function(done) {\n  this.ending = true\n\n  if (done && !this.running && !this.ended) {\n    return this.then(done)\n  }\n\n  return this\n}\n\n/**\n * Halt - Force kills the electron process immediately and empties the queue\n *\n * @param  {Error|String} error (Optional: defaults to 'Nightmare Halted'.) Error to pass to rejected promise\n * @param  {Function} done (Optional: defaults to no operation) callback when the child process exits\n * @return {Nightmare}       returns self\n */\nNightmare.prototype.halt = function(error, done) {\n  this.ending = true\n  var queue = this.queue() // empty the queue\n  queue.splice(0)\n  if (!this.ended) {\n    var message = error\n    if (error instanceof Error) {\n      message = error.message\n    }\n    this.die = message || DEFAULT_HALT_MESSAGE\n    if (typeof this._rejectActivePromise === 'function') {\n      this._rejectActivePromise(error || DEFAULT_HALT_MESSAGE)\n    }\n    var callback = done\n    if (!callback || typeof callback !== 'function') {\n      callback = noop\n    }\n    endInstance(this, callback, true)\n  }\n\n  return this\n}\n\n/**\n * on\n */\n\nNightmare.prototype.on = function(event, handler) {\n  this.queue(function(done) {\n    this.child.on(event, handler)\n    done()\n  })\n  return this\n}\n\n/**\n * once\n */\n\nNightmare.prototype.once = function(event, handler) {\n  this.queue(function(done) {\n    this.child.once(event, handler)\n    done()\n  })\n  return this\n}\n\n/**\n * removeEventListener\n */\n\nNightmare.prototype.removeListener = function(event, handler) {\n  this.child.removeListener(event, handler)\n  return this\n}\n\n/**\n * Queue\n */\n\nNightmare.prototype.queue = function(_done) {\n  if (!arguments.length) return this._queue\n  var args = sliced(arguments)\n  var fn = args.pop()\n  this._queue.push([fn, args])\n}\n\n/**\n * then\n */\n\nNightmare.prototype.then = function(fulfill, reject) {\n  var self = this\n\n  return new this.options.Promise(function(success, failure) {\n    self._rejectActivePromise = failure\n    self.run(function(err, result) {\n      if (err) failure(err)\n      else success(result)\n    })\n  }).then(fulfill, reject)\n}\n\n/**\n * catch\n */\n\nNightmare.prototype.catch = function(reject) {\n  this._rejectActivePromise = reject\n  return this.then(undefined, reject)\n}\n\n/**\n * use\n */\n\nNightmare.prototype.use = function(fn) {\n  fn(this)\n  return this\n}\n\n// wrap all the functions in the queueing function\nfunction queued(name, fn) {\n  return function action() {\n    debug('queueing action \"' + name + '\"')\n    var args = [].slice.call(arguments)\n    this._queue.push([fn, args])\n    return this\n  }\n}\n\n/**\n * Static: Support attaching custom actions\n *\n * @param {String} name - method name\n * @param {Function|Object} [childfn] - Electron implementation\n * @param {Function|Object} parentfn - Nightmare implementation\n * @return {Nightmare}\n */\n\nNightmare.action = function() {\n  var name = arguments[0],\n    childfn,\n    parentfn\n  if (arguments.length === 2) {\n    parentfn = arguments[1]\n  } else {\n    parentfn = arguments[2]\n    childfn = arguments[1]\n  }\n\n  // support functions and objects\n  // if it's an object, wrap it's\n  // properties in the queue function\n\n  if (parentfn) {\n    if (typeof parentfn === 'function') {\n      Nightmare.prototype[name] = queued(name, parentfn)\n    } else {\n      if (!~Nightmare.namespaces.indexOf(name)) {\n        Nightmare.namespaces.push(name)\n      }\n      Nightmare.prototype[name] = function() {\n        var self = this\n        return keys(parentfn).reduce(function(obj, key) {\n          obj[key] = queued(name, parentfn[key]).bind(self)\n          return obj\n        }, {})\n      }\n    }\n  }\n\n  if (childfn) {\n    if (typeof childfn === 'function') {\n      Nightmare.childActions[name] = childfn\n    } else {\n      for (var key in childfn) {\n        Nightmare.childActions[name + '.' + key] = childfn[key]\n      }\n    }\n  }\n}\n\n/**\n * Attach all the actions.\n */\n\nObject.keys(actions).forEach(function(name) {\n  var fn = actions[name]\n  Nightmare.action(name, fn)\n})\n"],"mappings":"AAAA;AACA;AACA;;AAEA,IAAIA,GAAG,GAAGC,OAAO,CAAC,OAAO,CAAC,CAAC,eAAe,CAAC;AAC3C,IAAIC,KAAK,GAAGD,OAAO,CAAC,OAAO,CAAC,CAAC,WAAW,CAAC;AACzC,IAAIE,WAAW,GAAG;EAChBC,MAAM,EAAEH,OAAO,CAAC,OAAO,CAAC,CAAC,iBAAiB,CAAC;EAC3CI,MAAM,EAAEJ,OAAO,CAAC,OAAO,CAAC,CAAC,iBAAiB;AAC5C,CAAC;;AAED;AACA;AACA;;AAEA,IAAIK,qBAAqB,GAAGL,OAAO,CAAC,UAAU,CAAC;AAC/C,IAAIM,IAAI,GAAGN,OAAO,CAAC,eAAe,CAAC;AACnC,IAAIO,OAAO,GAAGP,OAAO,CAAC,WAAW,CAAC;AAClC,IAAIQ,IAAI,GAAGR,OAAO,CAAC,MAAM,CAAC;AAC1B,IAAIS,MAAM,GAAGT,OAAO,CAAC,QAAQ,CAAC;AAC9B,IAAIU,KAAK,GAAGV,OAAO,CAAC,OAAO,CAAC;AAC5B,IAAIW,IAAI,GAAGX,OAAO,CAAC,MAAM,CAAC;AAC1B,IAAIY,MAAM,GAAGZ,OAAO,CAAC,QAAQ,CAAC;AAC9B,IAAIa,QAAQ,GAAGb,OAAO,CAAC,UAAU,CAAC;AAClC,IAAIc,IAAI,GAAG,SAAAA,CAAA,EAAW,CAAC,CAAC;AACxB,IAAIC,IAAI,GAAGC,MAAM,CAACD,IAAI;;AAEtB;AACA,MAAME,oBAAoB,GAAG,EAAE,GAAG,IAAI;AACtC;AACA,MAAMC,oBAAoB,GAAG,EAAE,GAAG,IAAI;AACtC;AACA,MAAMC,qBAAqB,GAAG,GAAG;AACjC;AACA,MAAMC,qBAAqB,GAAG,GAAG;AACjC;AACA,MAAMC,gBAAgB,GAAG,CAAC;AAC1B;AACA,MAAMC,yBAAyB,GAAG,EAAE,GAAG,IAAI;AAC3C;AACA,MAAMC,oBAAoB,GAAG,kBAAkB;AAC/C;AACA,MAAMC,iBAAiB,GAAG,WAAW;;AAErC;AACA;AACA;;AAEAC,MAAM,CAACC,OAAO,GAAGC,SAAS;;AAE1B;AACA;AACA;;AAEA,IAAIC,MAAM,GAAGpB,IAAI,CAACqB,IAAI,CAACC,SAAS,EAAE,WAAW,CAAC;;AAE9C;AACA;AACA;;AAEA,IAAIC,QAAQ,GAAG/B,OAAO,CAAC,cAAc,CAAC;;AAEtC;AACA;AACA;AACA;AACA;;AAEA,SAAS2B,SAASA,CAACK,OAAO,EAAE;EAC1B,IAAI,EAAE,IAAI,YAAYL,SAAS,CAAC,EAAE,OAAO,IAAIA,SAAS,CAACK,OAAO,CAAC;EAC/DA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;EACvB,IAAIC,YAAY,GAAG,CAAC,CAAC;EACrB,IAAIC,IAAI,GAAG,IAAI;EAEfF,OAAO,CAACG,WAAW,GAAGH,OAAO,CAACG,WAAW,IAAIjB,oBAAoB;EACjEc,OAAO,CAACI,WAAW,GAAGJ,OAAO,CAACI,WAAW,IAAInB,oBAAoB;EACjEe,OAAO,CAACK,YAAY,GAAGL,OAAO,CAACK,YAAY,IAAIjB,qBAAqB;EAEpEY,OAAO,CAACM,YAAY,GAAGN,OAAO,CAACM,YAAY,IAAInB,qBAAqB;EACpEa,OAAO,CAACO,gBAAgB,GACtBP,OAAO,CAACO,gBAAgB,IAAIjB,yBAAyB;EACvDU,OAAO,CAACQ,cAAc,GAAGR,OAAO,CAACQ,cAAc,IAAI,CAAC,CAAC;;EAErD;EACA;EACA;EACAR,OAAO,CAACQ,cAAc,CAACC,SAAS,GAC9BT,OAAO,CAACQ,cAAc,CAACC,SAAS,KAAKC,SAAS,GAC1CV,OAAO,CAACQ,cAAc,CAACC,SAAS,GAChCjB,iBAAiB;EAEvBQ,OAAO,CAACW,OAAO,GAAGX,OAAO,CAACW,OAAO,IAAIhB,SAAS,CAACgB,OAAO,IAAIA,OAAO;EAEjE,IAAIC,aAAa,GAAGZ,OAAO,CAACa,YAAY,IAAIxC,qBAAqB;EAEjE,IAAI2B,OAAO,CAACc,KAAK,EAAE;IACjBb,YAAY,CAACa,KAAK,GAAGd,OAAO,CAACc,KAAK;EACpC;EAEA,IAAId,OAAO,CAACe,QAAQ,EAAE;IACpBd,YAAY,CAACc,QAAQ,GAAGf,OAAO,CAACe,QAAQ;EAC1C;EACAf,OAAO,CAACgB,cAAc,GAAGhB,OAAO,CAACgB,cAAc,IAAI3B,gBAAgB;EAEnEY,YAAY,CAACgB,WAAW,GAAGjB,OAAO,CAACiB,WAAW;EAC9C,IACEjB,OAAO,CAACiB,WAAW,IACnBjB,OAAO,CAACI,WAAW,IACnBJ,OAAO,CAACiB,WAAW,GAAGjB,OAAO,CAACI,WAAW,EACzC;IACAnC,KAAK,CACF,6BACC+B,OAAO,CAACiB,WACT,oCAAmCjB,OAAO,CAACI,WAAY,EAC1D,CAAC;EACH;EAEAH,YAAY,CAACiB,IAAI,GAAGlB,OAAO,CAACkB,IAAI,IAAI,KAAK;EACzCjB,YAAY,CAACkB,sBAAsB,GAAGnB,OAAO,CAACmB,sBAAsB,IAAI,IAAI;EAE5EC,eAAe,CAAC,IAAI,CAAC;;EAErB;EACA,IAAI,CAACC,KAAK,GAAG,SAAS;EACtB,IAAI,CAACC,OAAO,GAAG,KAAK;EACpB,IAAI,CAACC,MAAM,GAAG,KAAK;EACnB,IAAI,CAACC,KAAK,GAAG,KAAK;EAClB,IAAI,CAACC,MAAM,GAAG,EAAE;EAChB,IAAI,CAACC,QAAQ,GAAG,CAAC,CAAC;EAClB,IAAI,CAAC1B,OAAO,GAAGA,OAAO;EAEtB/B,KAAK,CAAC,uBAAuB,CAAC;EAC9B,IAAI,CAAC0D,KAAK,CAACC,IAAI,IAAI;IACjB,IAAI,CAACtD,IAAI,GAAGA,IAAI,CAACuD,KAAK,CACpBjB,aAAa,EACb,CAAChB,MAAM,CAAC,CAACkC,MAAM,CAACC,IAAI,CAACC,SAAS,CAAC/B,YAAY,CAAC,CAAC,EAC7C;MACEgC,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC;MAChCC,GAAG,EAAErD,QAAQ,CAACmB,OAAO,CAACkC,GAAG,IAAI,CAAC,CAAC,EAAEC,OAAO,CAACD,GAAG;IAC9C,CACF,CAAC;IAED,IAAI,CAAC5D,IAAI,CAACH,MAAM,CAACiE,IAAI,CAACxD,MAAM,CAAC,CAAC,CAAC,CAACyD,EAAE,CAAC,MAAM,EAAEC,IAAI,IAAI;MACjDpE,WAAW,CAACC,MAAM,CAACmE,IAAI,CAAC;IAC1B,CAAC,CAAC;IAEF,IAAI,CAAChE,IAAI,CAACF,MAAM,CAACgE,IAAI,CAACxD,MAAM,CAAC,CAAC,CAAC,CAACyD,EAAE,CAAC,MAAM,EAAEC,IAAI,IAAI;MACjDpE,WAAW,CAACE,MAAM,CAACkE,IAAI,CAAC;IAC1B,CAAC,CAAC;IAEF,IAAI,CAAChE,IAAI,CAAC+D,EAAE,CAAC,OAAO,EAAEE,IAAI,IAAI;MAC5B,IAAI,CAACrC,IAAI,CAACsB,KAAK,EAAE;QACfgB,UAAU,CAACD,IAAI,EAAErC,IAAI,EAAEpB,IAAI,CAAC;MAC9B;IACF,CAAC,CAAC;IAEF,IAAI,CAACJ,KAAK,GAAGA,KAAK,CAAC,IAAI,CAACJ,IAAI,CAAC;IAE7B,IAAI,CAACI,KAAK,CAACC,IAAI,CAAC,KAAK,EAAE,UAAS8D,GAAG,EAAE;MACnCxE,KAAK,CAAC,SAAS,GAAGwE,GAAG,CAAC;MACtBvC,IAAI,CAACwC,GAAG,GAAGD,GAAG;IAChB,CAAC,CAAC;;IAEF;IACA,IAAI,CAAC/D,KAAK,CAAC2D,EAAE,CAAC,KAAK,EAAE,YAAW;MAC9BtE,GAAG,CAAC4E,KAAK,CAAC5E,GAAG,EAAE6E,SAAS,CAAC;IAC3B,CAAC,CAAC;IAEF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,mBAAmB,EAAE,UAASI,GAAG,EAAE;MAC/C,MAAMI,CAAC,GAAG,IAAIC,KAAK,CAAC,0BAA0B,GAAGL,GAAG,CAACM,OAAO,CAAC;MAC7DF,CAAC,CAACG,KAAK,GAAGP,GAAG,CAACO,KAAK,IAAI,EAAE;MAEzB,MAAMC,OAAO,GAAGA,CAAA,KAAM;QACpB,MAAMR,GAAG;MACX,CAAC;MAEDS,WAAW,CAAChD,IAAI,EAAE+C,OAAO,EAAE,IAAI,CAAC;IAClC,CAAC,CAAC;IAEF,IAAI,CAACvE,KAAK,CAAC2D,EAAE,CAAC,MAAM,EAAE,UAASc,IAAI,EAAE;MACnCpF,GAAG,CAAC4E,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,GAAGQ,IAAI,CAAC,CAACrB,MAAM,CAACrD,MAAM,CAACmE,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC;IAChE,CAAC,CAAC;;IAEF;IACA,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,iBAAiB,EAAE,YAAW;MAC1CtE,GAAG,CAAC,iBAAiB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IAC3D,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,eAAe,EAAE,YAAW;MACxCtE,GAAG,CAAC,eAAe,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,2BAA2B,EAAE,YAAW;MACpDtE,GAAG,CAAC,2BAA2B,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACrE,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,uBAAuB,EAAE,YAAW;MAChDtE,GAAG,CAAC,uBAAuB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACjE,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,mBAAmB,EAAE,YAAW;MAC5CtE,GAAG,CAAC,mBAAmB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IAC7D,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,kBAAkB,EAAE,YAAW;MAC3CtE,GAAG,CAAC,kBAAkB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,0BAA0B,EAAE,YAAW;MACnDtE,GAAG,CAAC,0BAA0B,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACpE,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,0BAA0B,EAAE,YAAW;MACnDtE,GAAG,CAAC,0BAA0B,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACpE,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,WAAW,EAAE,YAAW;MACpCtE,GAAG,CAAC,WAAW,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACrD,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,sBAAsB,EAAE,YAAW;MAC/CtE,GAAG,CAAC,sBAAsB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IAChE,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,YAAY,EAAE,YAAW;MACrCtE,GAAG,CAAC,YAAY,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACtD,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,eAAe,EAAE,YAAW;MACxCtE,GAAG,CAAC,eAAe,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,SAAS,EAAE,YAAW;MAClCtE,GAAG,CAAC,SAAS,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACnD,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,gBAAgB,EAAE,YAAW;MACzCtE,GAAG,CAAC,gBAAgB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IAC1D,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,WAAW,EAAE,YAAW;MACpCtE,GAAG,CAAC,WAAW,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACrD,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,uBAAuB,EAAE,YAAW;MAChDtE,GAAG,CAAC,uBAAuB,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACjE,CAAC,CAAC;IACF,IAAI,CAAClE,KAAK,CAAC2D,EAAE,CAAC,cAAc,EAAE,YAAW;MACvCtE,GAAG,CAAC,cAAc,EAAEgE,IAAI,CAACC,SAAS,CAACvD,MAAM,CAACmE,SAAS,CAAC,CAAC,CAAC;IACxD,CAAC,CAAC;IAEF,IAAI,CAAClE,KAAK,CAACC,IAAI,CAAC,OAAO,EAAEyE,QAAQ,IAAI;MACnC,IAAI,CAACC,cAAc,GAAGD,QAAQ;MAC9B,IAAI,CAAC1E,KAAK,CAAC4E,IAAI,CAAC,oBAAoB,EAAEtD,OAAO,EAAE,YAAW;QACxDE,IAAI,CAACmB,KAAK,GAAG,OAAO;QACpBO,IAAI,CAAC,CAAC;MACR,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;;EAEF;EACAjC,SAAS,CAAC4D,UAAU,CAACC,OAAO,CAAC,UAASC,IAAI,EAAE;IAC1C,IAAI,UAAU,KAAK,OAAO,IAAI,CAACA,IAAI,CAAC,EAAE;MACpC,IAAI,CAACA,IAAI,CAAC,GAAG,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC;IAC3B;EACF,CAAC,EAAE,IAAI,CAAC;;EAER;EACAzE,MAAM,CAACD,IAAI,CAACY,SAAS,CAAC+D,YAAY,CAAC,CAACF,OAAO,CAAC,UAASG,GAAG,EAAE;IACxD1F,KAAK,CAAC,yCAAyC,EAAE0F,GAAG,CAAC;IACrD,IAAI,CAAChC,KAAK,CAAC,UAASC,IAAI,EAAE;MACxB,IAAI,CAAClD,KAAK,CAAC4E,IAAI,CAAC,QAAQ,EAAEK,GAAG,EAAEC,MAAM,CAACjE,SAAS,CAAC+D,YAAY,CAACC,GAAG,CAAC,CAAC,EAAE/B,IAAI,CAAC;IAC3E,CAAC,CAAC;EACJ,CAAC,EAAE,IAAI,CAAC;AACV;AAEA,SAASY,UAAUA,CAACD,IAAI,EAAEsB,QAAQ,EAAEC,EAAE,EAAE;EACtC,IAAIC,IAAI,GAAG;IACT,GAAG,EAAE,mEAAmE;IACxE,GAAG,EAAE,mHAAmH;IACxH,CAAC,EAAE,mCAAmC;IACtC,CAAC,EAAE;EACL,CAAC;EAED9F,KAAK,CAAC,0CAA0C,GAAGsE,IAAI,GAAG,IAAI,GAAGwB,IAAI,CAACxB,IAAI,CAAC,CAAC;EAC5EsB,QAAQ,CAACvF,IAAI,CAAC0F,kBAAkB,CAAC,CAAC;EAClCF,EAAE,CAAC,CAAC;AACN;AAEA,SAASZ,WAAWA,CAACW,QAAQ,EAAEC,EAAE,EAAEG,SAAS,EAAE;EAC5CJ,QAAQ,CAACrC,KAAK,GAAG,IAAI;EACrB0C,iBAAiB,CAACL,QAAQ,CAAC;EAC3B,IAAIA,QAAQ,CAACvF,IAAI,IAAIuF,QAAQ,CAACvF,IAAI,CAAC6F,SAAS,EAAE;IAC5CN,QAAQ,CAACvF,IAAI,CAAC+D,EAAE,CAAC,OAAO,EAAEE,IAAI,IAAI;MAChCC,UAAU,CAACD,IAAI,EAAEsB,QAAQ,EAAEC,EAAE,CAAC;IAChC,CAAC,CAAC;IACFD,QAAQ,CAACnF,KAAK,CAAC4E,IAAI,CAAC,MAAM,EAAE,MAAM;MAChCO,QAAQ,CAACnF,KAAK,CAACsF,kBAAkB,CAAC,CAAC;MACnC,IAAIC,SAAS,EAAE;QACbJ,QAAQ,CAACvF,IAAI,CAAC8F,IAAI,CAAC,QAAQ,CAAC;MAC9B;IACF,CAAC,CAAC;EACJ,CAAC,MAAM;IACLnG,KAAK,CAAC,wDAAwD,CAAC;IAC/D6F,EAAE,CAAC,CAAC;EACN;AACF;;AAEA;AACA;AACA;AACA,SAAS1C,eAAeA,CAACyC,QAAQ,EAAE;EACjCA,QAAQ,CAACQ,OAAO,GAAGnB,WAAW,CAACoB,IAAI,CAAC,IAAI,EAAET,QAAQ,EAAE/E,IAAI,CAAC;EACzDqD,OAAO,CAACoC,eAAe,CAACC,QAAQ,CAAC;EACjCrC,OAAO,CAACE,EAAE,CAAC,MAAM,EAAEwB,QAAQ,CAACQ,OAAO,CAAC;EACpClC,OAAO,CAACE,EAAE,CAAC,QAAQ,EAAEwB,QAAQ,CAACQ,OAAO,CAAC;EACtClC,OAAO,CAACE,EAAE,CAAC,SAAS,EAAEwB,QAAQ,CAACQ,OAAO,CAAC;EACvClC,OAAO,CAACE,EAAE,CAAC,SAAS,EAAEwB,QAAQ,CAACQ,OAAO,CAAC;EACvClC,OAAO,CAACE,EAAE,CAAC,QAAQ,EAAEwB,QAAQ,CAACQ,OAAO,CAAC;EACtClC,OAAO,CAACE,EAAE,CAAC,UAAU,EAAEwB,QAAQ,CAACQ,OAAO,CAAC;AAC1C;AAEA,SAASH,iBAAiBA,CAACL,QAAQ,EAAE;EACnC1B,OAAO,CAACsC,cAAc,CAAC,MAAM,EAAEZ,QAAQ,CAACQ,OAAO,CAAC;EAChDlC,OAAO,CAACsC,cAAc,CAAC,QAAQ,EAAEZ,QAAQ,CAACQ,OAAO,CAAC;EAClDlC,OAAO,CAACsC,cAAc,CAAC,SAAS,EAAEZ,QAAQ,CAACQ,OAAO,CAAC;EACnDlC,OAAO,CAACsC,cAAc,CAAC,SAAS,EAAEZ,QAAQ,CAACQ,OAAO,CAAC;EACnDlC,OAAO,CAACsC,cAAc,CAAC,QAAQ,EAAEZ,QAAQ,CAACQ,OAAO,CAAC;EAClDlC,OAAO,CAACsC,cAAc,CAAC,UAAU,EAAEZ,QAAQ,CAACQ,OAAO,CAAC;AACtD;;AAEA;AACA;AACA;;AAEA1E,SAAS,CAAC4D,UAAU,GAAG,EAAE;;AAEzB;AACA;AACA;;AAEA5D,SAAS,CAAC+D,YAAY,GAAG,CAAC,CAAC;;AAE3B;AACA;AACA;AACA/D,SAAS,CAAC+E,OAAO,GAAG1G,OAAO,CAACQ,IAAI,CAACmG,OAAO,CACtC7E,SAAS,EACT,IAAI,EACJ,cACF,CAAC,CAAC,CAAC4E,OAAO;;AAEV;AACA;AACA;;AAEA/E,SAAS,CAACgB,OAAO,GAAGA,OAAO;;AAE3B;AACA;AACA;;AAEAhB,SAAS,CAACiF,SAAS,CAACC,MAAM,GAAG,UAASA,MAAM,EAAEC,KAAK,EAAE;EACnD,IAAID,MAAM,IAAI,OAAOC,KAAK,KAAK,WAAW,EAAE;IAC1C,IAAI,CAACpD,QAAQ,CAACmD,MAAM,CAAC,GAAGC,KAAK;EAC/B,CAAC,MAAM;IACL,IAAI,CAACpD,QAAQ,GAAGmD,MAAM,IAAI,CAAC,CAAC;EAC9B;EAEA,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAlF,SAAS,CAACiF,SAAS,CAACG,IAAI,GAAG,UAASC,GAAG,EAAEC,OAAO,EAAE;EAChDhH,KAAK,CAAC,+BAA+B,EAAE+G,GAAG,CAAC;EAC3C,IAAI9E,IAAI,GAAG,IAAI;EAEf+E,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;EACvB,KAAK,IAAItB,GAAG,IAAI,IAAI,CAACjC,QAAQ,EAAE;IAC7BuD,OAAO,CAACtB,GAAG,CAAC,GAAGsB,OAAO,CAACtB,GAAG,CAAC,IAAI,IAAI,CAACjC,QAAQ,CAACiC,GAAG,CAAC;EACnD;EAEA,IAAI,CAAChC,KAAK,CAAC,UAASuD,EAAE,EAAE;IACtBhF,IAAI,CAACxB,KAAK,CAAC4E,IAAI,CAAC,MAAM,EAAE0B,GAAG,EAAEC,OAAO,EAAE,IAAI,CAACjF,OAAO,CAACI,WAAW,EAAE8E,EAAE,CAAC;EACrE,CAAC,CAAC;EACF,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAvF,SAAS,CAACiF,SAAS,CAACO,GAAG,GAAG,UAASD,EAAE,EAAE;EACrCjH,KAAK,CAAC,SAAS,CAAC;EAChB,IAAImH,KAAK,GAAG,IAAI,CAACzD,KAAK,CAAC,CAAC;EACxB,IAAI,CAACL,OAAO,GAAG,IAAI;EACnB,IAAI,CAACG,MAAM,GAAG,EAAE;EAChB,IAAIvB,IAAI,GAAG,IAAI;;EAEf;EACAmF,IAAI,CAAC,CAAC;;EAEN;EACA,SAASA,IAAIA,CAAC5C,GAAG,EAAE6C,IAAI,EAAE;IACvB,IAAIC,IAAI,GAAGH,KAAK,CAACI,KAAK,CAAC,CAAC;IACxB;IACA,IAAI/C,GAAG,IAAI,CAAC8C,IAAI,EAAE,OAAO3D,IAAI,CAACe,KAAK,CAACzC,IAAI,EAAE0C,SAAS,CAAC;IACpD,IAAI6C,IAAI,GAAGF,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE;IACxB,IAAIG,MAAM,GAAGH,IAAI,CAAC,CAAC,CAAC;IACpBE,IAAI,CAACE,IAAI,CAAChH,IAAI,CAACiH,KAAK,CAAC,CAAC;IACtBF,MAAM,CAAC/C,KAAK,CAACzC,IAAI,EAAEuF,IAAI,CAAC;EAC1B;EAEA,SAASG,KAAKA,CAACnD,GAAG,EAAE6C,IAAI,EAAE;IACxB7C,GAAG,GAAGA,GAAG,IAAIvC,IAAI,CAACwC,GAAG;IACrB,IAAI+C,IAAI,GAAG,CAAChD,GAAG,CAAC,CAACX,MAAM,CAACrD,MAAM,CAACmE,SAAS,EAAE,CAAC,CAAC,CAAC;IAE7C,IAAI1C,IAAI,CAACxB,KAAK,EAAE;MACdwB,IAAI,CAACxB,KAAK,CAAC4E,IAAI,CAAC,UAAU,EAAE,MAAM+B,IAAI,CAAC1C,KAAK,CAACzC,IAAI,EAAEuF,IAAI,CAAC,CAAC;IAC3D,CAAC,MAAM;MACLJ,IAAI,CAAC1C,KAAK,CAACzC,IAAI,EAAEuF,IAAI,CAAC;IACxB;EACF;EAEA,SAAS7D,IAAIA,CAAA,EAAG;IACd,IAAIiE,QAAQ,GAAGjD,SAAS;IACxB1C,IAAI,CAACoB,OAAO,GAAG,KAAK;IACpB,IAAIpB,IAAI,CAACqB,MAAM,EAAE;MACf,OAAO2B,WAAW,CAAChD,IAAI,EAAE,MAAMgF,EAAE,CAACvC,KAAK,CAACzC,IAAI,EAAE2F,QAAQ,CAAC,CAAC;IAC1D;IACA,OAAOX,EAAE,CAACvC,KAAK,CAACzC,IAAI,EAAE2F,QAAQ,CAAC;EACjC;EAEA,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAlG,SAAS,CAACiF,SAAS,CAACkB,YAAY,GAAG,UAASC,KAAK,EAAEnE,IAAI,EAAE;EACvD,IAAI6D,IAAI,GAAGO,KAAK,CAACpB,SAAS,CAACqB,KAAK,CAC7B3C,IAAI,CAACV,SAAS,CAAC,CACfqD,KAAK,CAAC,CAAC,CAAC,CACRC,GAAG,CAACC,CAAC,IAAI;IACR,OAAO;MAAEC,QAAQ,EAAErE,IAAI,CAACC,SAAS,CAACmE,CAAC;IAAE,CAAC;EACxC,CAAC,CAAC;EACJ,IAAIE,MAAM,GAAGtG,QAAQ,CAACuG,OAAO,CAAC;IAAEC,GAAG,EAAE3C,MAAM,CAACmC,KAAK,CAAC;IAAEN,IAAI,EAAEA;EAAK,CAAC,CAAC;EACjE,IAAI,CAAC/G,KAAK,CAAC4E,IAAI,CAAC,YAAY,EAAE+C,MAAM,EAAEzE,IAAI,CAAC;EAC3C,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAjC,SAAS,CAACiF,SAAS,CAAC4B,OAAO,GAAG,UAASC,EAAE,EAAE7E,IAAI,EAAE;EAC/C,IAAI,CAAClD,KAAK,CAAC4E,IAAI,CAAC,YAAY,EAAEvD,QAAQ,CAAC2G,MAAM,CAAC;IAAEH,GAAG,EAAEE;EAAG,CAAC,CAAC,EAAE7E,IAAI,CAAC;EACjE,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAjC,SAAS,CAACiF,SAAS,CAAC+B,GAAG,GAAG,UAAS/E,IAAI,EAAE;EACvC,IAAI,CAACL,MAAM,GAAG,IAAI;EAElB,IAAIK,IAAI,IAAI,CAAC,IAAI,CAACN,OAAO,IAAI,CAAC,IAAI,CAACE,KAAK,EAAE;IACxC,OAAO,IAAI,CAACoF,IAAI,CAAChF,IAAI,CAAC;EACxB;EAEA,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACAjC,SAAS,CAACiF,SAAS,CAACiC,IAAI,GAAG,UAASC,KAAK,EAAElF,IAAI,EAAE;EAC/C,IAAI,CAACL,MAAM,GAAG,IAAI;EAClB,IAAII,KAAK,GAAG,IAAI,CAACA,KAAK,CAAC,CAAC,EAAC;EACzBA,KAAK,CAACoF,MAAM,CAAC,CAAC,CAAC;EACf,IAAI,CAAC,IAAI,CAACvF,KAAK,EAAE;IACf,IAAIuB,OAAO,GAAG+D,KAAK;IACnB,IAAIA,KAAK,YAAYhE,KAAK,EAAE;MAC1BC,OAAO,GAAG+D,KAAK,CAAC/D,OAAO;IACzB;IACA,IAAI,CAACL,GAAG,GAAGK,OAAO,IAAIxD,oBAAoB;IAC1C,IAAI,OAAO,IAAI,CAACyH,oBAAoB,KAAK,UAAU,EAAE;MACnD,IAAI,CAACA,oBAAoB,CAACF,KAAK,IAAIvH,oBAAoB,CAAC;IAC1D;IACA,IAAI0H,QAAQ,GAAGrF,IAAI;IACnB,IAAI,CAACqF,QAAQ,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;MAC/CA,QAAQ,GAAGnI,IAAI;IACjB;IACAoE,WAAW,CAAC,IAAI,EAAE+D,QAAQ,EAAE,IAAI,CAAC;EACnC;EAEA,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAtH,SAAS,CAACiF,SAAS,CAACvC,EAAE,GAAG,UAAS6E,KAAK,EAAEC,OAAO,EAAE;EAChD,IAAI,CAACxF,KAAK,CAAC,UAASC,IAAI,EAAE;IACxB,IAAI,CAAClD,KAAK,CAAC2D,EAAE,CAAC6E,KAAK,EAAEC,OAAO,CAAC;IAC7BvF,IAAI,CAAC,CAAC;EACR,CAAC,CAAC;EACF,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAjC,SAAS,CAACiF,SAAS,CAACjG,IAAI,GAAG,UAASuI,KAAK,EAAEC,OAAO,EAAE;EAClD,IAAI,CAACxF,KAAK,CAAC,UAASC,IAAI,EAAE;IACxB,IAAI,CAAClD,KAAK,CAACC,IAAI,CAACuI,KAAK,EAAEC,OAAO,CAAC;IAC/BvF,IAAI,CAAC,CAAC;EACR,CAAC,CAAC;EACF,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAjC,SAAS,CAACiF,SAAS,CAACH,cAAc,GAAG,UAASyC,KAAK,EAAEC,OAAO,EAAE;EAC5D,IAAI,CAACzI,KAAK,CAAC+F,cAAc,CAACyC,KAAK,EAAEC,OAAO,CAAC;EACzC,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;;AAEAxH,SAAS,CAACiF,SAAS,CAACjD,KAAK,GAAG,UAASyF,KAAK,EAAE;EAC1C,IAAI,CAACxE,SAAS,CAACyE,MAAM,EAAE,OAAO,IAAI,CAAC5F,MAAM;EACzC,IAAIgE,IAAI,GAAGhH,MAAM,CAACmE,SAAS,CAAC;EAC5B,IAAIsC,EAAE,GAAGO,IAAI,CAAC6B,GAAG,CAAC,CAAC;EACnB,IAAI,CAAC7F,MAAM,CAACkE,IAAI,CAAC,CAACT,EAAE,EAAEO,IAAI,CAAC,CAAC;AAC9B,CAAC;;AAED;AACA;AACA;;AAEA9F,SAAS,CAACiF,SAAS,CAACgC,IAAI,GAAG,UAASW,OAAO,EAAEC,MAAM,EAAE;EACnD,IAAItH,IAAI,GAAG,IAAI;EAEf,OAAO,IAAI,IAAI,CAACF,OAAO,CAACW,OAAO,CAAC,UAAS8G,OAAO,EAAEC,OAAO,EAAE;IACzDxH,IAAI,CAAC8G,oBAAoB,GAAGU,OAAO;IACnCxH,IAAI,CAACiF,GAAG,CAAC,UAAS1C,GAAG,EAAEkF,MAAM,EAAE;MAC7B,IAAIlF,GAAG,EAAEiF,OAAO,CAACjF,GAAG,CAAC,MAChBgF,OAAO,CAACE,MAAM,CAAC;IACtB,CAAC,CAAC;EACJ,CAAC,CAAC,CAACf,IAAI,CAACW,OAAO,EAAEC,MAAM,CAAC;AAC1B,CAAC;;AAED;AACA;AACA;;AAEA7H,SAAS,CAACiF,SAAS,CAACgD,KAAK,GAAG,UAASJ,MAAM,EAAE;EAC3C,IAAI,CAACR,oBAAoB,GAAGQ,MAAM;EAClC,OAAO,IAAI,CAACZ,IAAI,CAAClG,SAAS,EAAE8G,MAAM,CAAC;AACrC,CAAC;;AAED;AACA;AACA;;AAEA7H,SAAS,CAACiF,SAAS,CAACiD,GAAG,GAAG,UAAS3C,EAAE,EAAE;EACrCA,EAAE,CAAC,IAAI,CAAC;EACR,OAAO,IAAI;AACb,CAAC;;AAED;AACA,SAAS4C,MAAMA,CAACrE,IAAI,EAAEyB,EAAE,EAAE;EACxB,OAAO,SAAS6C,MAAMA,CAAA,EAAG;IACvB9J,KAAK,CAAC,mBAAmB,GAAGwF,IAAI,GAAG,GAAG,CAAC;IACvC,IAAIgC,IAAI,GAAG,EAAE,CAACQ,KAAK,CAAC3C,IAAI,CAACV,SAAS,CAAC;IACnC,IAAI,CAACnB,MAAM,CAACkE,IAAI,CAAC,CAACT,EAAE,EAAEO,IAAI,CAAC,CAAC;IAC5B,OAAO,IAAI;EACb,CAAC;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA9F,SAAS,CAACoI,MAAM,GAAG,YAAW;EAC5B,IAAItE,IAAI,GAAGb,SAAS,CAAC,CAAC,CAAC;IACrBoF,OAAO;IACPC,QAAQ;EACV,IAAIrF,SAAS,CAACyE,MAAM,KAAK,CAAC,EAAE;IAC1BY,QAAQ,GAAGrF,SAAS,CAAC,CAAC,CAAC;EACzB,CAAC,MAAM;IACLqF,QAAQ,GAAGrF,SAAS,CAAC,CAAC,CAAC;IACvBoF,OAAO,GAAGpF,SAAS,CAAC,CAAC,CAAC;EACxB;;EAEA;EACA;EACA;;EAEA,IAAIqF,QAAQ,EAAE;IACZ,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;MAClCtI,SAAS,CAACiF,SAAS,CAACnB,IAAI,CAAC,GAAGqE,MAAM,CAACrE,IAAI,EAAEwE,QAAQ,CAAC;IACpD,CAAC,MAAM;MACL,IAAI,CAAC,CAACtI,SAAS,CAAC4D,UAAU,CAAC2E,OAAO,CAACzE,IAAI,CAAC,EAAE;QACxC9D,SAAS,CAAC4D,UAAU,CAACoC,IAAI,CAAClC,IAAI,CAAC;MACjC;MACA9D,SAAS,CAACiF,SAAS,CAACnB,IAAI,CAAC,GAAG,YAAW;QACrC,IAAIvD,IAAI,GAAG,IAAI;QACf,OAAOnB,IAAI,CAACkJ,QAAQ,CAAC,CAACE,MAAM,CAAC,UAASC,GAAG,EAAEzE,GAAG,EAAE;UAC9CyE,GAAG,CAACzE,GAAG,CAAC,GAAGmE,MAAM,CAACrE,IAAI,EAAEwE,QAAQ,CAACtE,GAAG,CAAC,CAAC,CAACW,IAAI,CAACpE,IAAI,CAAC;UACjD,OAAOkI,GAAG;QACZ,CAAC,EAAE,CAAC,CAAC,CAAC;MACR,CAAC;IACH;EACF;EAEA,IAAIJ,OAAO,EAAE;IACX,IAAI,OAAOA,OAAO,KAAK,UAAU,EAAE;MACjCrI,SAAS,CAAC+D,YAAY,CAACD,IAAI,CAAC,GAAGuE,OAAO;IACxC,CAAC,MAAM;MACL,KAAK,IAAIrE,GAAG,IAAIqE,OAAO,EAAE;QACvBrI,SAAS,CAAC+D,YAAY,CAACD,IAAI,GAAG,GAAG,GAAGE,GAAG,CAAC,GAAGqE,OAAO,CAACrE,GAAG,CAAC;MACzD;IACF;EACF;AACF,CAAC;;AAED;AACA;AACA;;AAEA3E,MAAM,CAACD,IAAI,CAACR,OAAO,CAAC,CAACiF,OAAO,CAAC,UAASC,IAAI,EAAE;EAC1C,IAAIyB,EAAE,GAAG3G,OAAO,CAACkF,IAAI,CAAC;EACtB9D,SAAS,CAACoI,MAAM,CAACtE,IAAI,EAAEyB,EAAE,CAAC;AAC5B,CAAC,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}